import{r as l,q as m,o as h,c as p,a as f,j as e,d as b,R as N,b as v}from"./index-DI5tGd7w.js";const w=t=>t>0?"text-green-600":t<0?"text-red-600":"text-zinc-700",y=t=>`${t>0?"+":""}${Number(t).toFixed(0)}%`,o=t=>{if(!t)return null;if(typeof t?.toDate=="function")return t.toDate();if(t instanceof Date)return t;if(typeof t=="string"){const i=new Date(t);return isNaN(+i)?null:i}return null},D=(t,i)=>Math.round(t*(1+i/100)*100)/100;function k(){const[t,i]=l.useState([]),[x,g]=l.useState([]);l.useEffect(()=>{const s=m(p(b,"newsQueue"),h("order","asc")),r=f(s,c=>{const a=[];c.forEach(n=>a.push({id:n.id,...n.data()})),i(a)});return()=>r()},[]),l.useEffect(()=>{const s=m(p(b,"stocks"),h("order","asc")),r=f(s,c=>{const a=[];c.forEach(n=>a.push({id:n.id,...n.data()})),g(a.filter(n=>n.isPublished!==!1))});return()=>r()},[]);const d=l.useMemo(()=>{const s=new Date;return t.filter(c=>c.publishAt).map(c=>({...c,d:o(c.publishAt)})).filter(c=>c.d&&s>=c.d).sort((c,a)=>+c.d-+a.d).at(-1)??null},[t]),u=l.useMemo(()=>{const s=new Date;return x.map(r=>{const c=o(r.applyAt),n=r.scheduledDelta!==null&&r.scheduledDelta!==void 0&&c!==null&&s>=c?Number(r.scheduledDelta):r.deltaPct,j=D(Number(r.basePrice||0),n);return{...r,effectiveDelta:n,currentPrice:j}})},[x]);return e.jsx("div",{className:"min-h-screen newspaper-bg text-zinc-900",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-10",children:[e.jsx("h1",{className:"gothic-title text-5xl md:text-6xl text-center font-black drop-shadow-sm",children:"The Timeless"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-10",children:[e.jsxs("div",{className:"card-nb p-6 md:p-8",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"text-xs text-zinc-500",children:"주목할 뉴스"})}),d?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mt-3 text-2xl md:text-3xl font-bold leading-snug",children:d.headline||"제목 없음"}),e.jsx("p",{className:"mt-4 whitespace-pre-wrap leading-relaxed text-[15px] md:text-base",children:d.body||""}),e.jsxs("div",{className:"mt-6 text-right text-xs text-zinc-500",children:["노출 시각:"," ",o(d.publishAt)?.toLocaleString?.()??"—"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mt-3 text-2xl md:text-3xl font-bold leading-snug",children:"(대기중)"}),e.jsx("p",{className:"mt-4 text-[15px] md:text-base text-zinc-600",children:"예약된 노출 시간이 되면 뉴스가 표시됩니다."})]})]}),e.jsxs("div",{className:"card-nb p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold tracking-wide",children:"시장 동향"}),e.jsx("span",{className:"text-xs text-zinc-500",children:"예약/실시간 반영"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_auto_auto] px-2 py-2 text-xs text-zinc-500 uppercase tracking-wider border-b",children:[e.jsx("div",{children:"주식사 / 설명"}),e.jsx("div",{className:"text-right pr-2",children:"등락%"}),e.jsx("div",{className:"text-right",children:"가격"})]}),u.length===0&&e.jsx("div",{className:"py-10 text-center text-zinc-500",children:"공개된 종목이 없습니다."}),u.map(s=>e.jsxs("div",{className:"grid grid-cols-[1fr_auto_auto] gap-2 items-center px-2 py-3 border-b last:border-b-0",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"relative inline-block group",children:[e.jsx("div",{className:"font-bold text-xs",children:s.name}),s.sector&&s.sector.trim()!==""&&e.jsx("div",{className:"pointer-events-none absolute z-10 hidden group-hover:block left-0 top-full mt-1 whitespace-nowrap rounded-md bg-black/80 text-white text-[11px] px-2 py-1 shadow",children:s.sector})]}),e.jsx("div",{className:"text-xs text-zinc-600",children:s.description})]}),e.jsx("div",{className:`text-right text-lg font-bold ${w(s.effectiveDelta)}`,children:y(s.effectiveDelta)}),e.jsx("div",{className:"text-right font-semibold tabular-nums",children:Number.isFinite(s.currentPrice)?s.currentPrice.toLocaleString():"—"})]},s.id))]})]})]})]})})}N.createRoot(document.getElementById("root")).render(e.jsx(v.StrictMode,{children:e.jsx(k,{})}));
