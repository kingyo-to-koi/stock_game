import{r as l,q as m,o as h,c as p,a as f,j as e,d as g,R as N,b as v}from"./index-CbXKR1xy.js";const w=t=>t>0?"text-green-600":t<0?"text-red-600":"text-zinc-700",y=t=>`${t>0?"+":""}${Number(t).toFixed(0)}%`,o=t=>{if(!t)return null;if(typeof t?.toDate=="function")return t.toDate();if(t instanceof Date)return t;if(typeof t=="string"){const i=new Date(t);return isNaN(+i)?null:i}return null},D=(t,i)=>Math.round(t*(1+i/100)*100)/100;function S(){const[t,i]=l.useState([]),[x,j]=l.useState([]);l.useEffect(()=>{const c=m(p(g,"newsQueue"),h("order","asc")),n=f(c,s=>{const a=[];s.forEach(r=>a.push({id:r.id,...r.data()})),i(a)});return()=>n()},[]),l.useEffect(()=>{const c=m(p(g,"stocks"),h("order","asc")),n=f(c,s=>{const a=[];s.forEach(r=>a.push({id:r.id,...r.data()})),j(a.filter(r=>r.isPublished!==!1))});return()=>n()},[]);const d=l.useMemo(()=>{const c=new Date;return t.filter(s=>s.publishAt).map(s=>({...s,d:o(s.publishAt)})).filter(s=>s.d&&c>=s.d).sort((s,a)=>+s.d-+a.d).at(-1)??null},[t]),u=l.useMemo(()=>{const c=new Date;return x.map(n=>{const s=o(n.applyAt),r=n.scheduledDelta!==null&&n.scheduledDelta!==void 0&&s!==null&&c>=s?Number(n.scheduledDelta):n.deltaPct,b=D(Number(n.basePrice||0),r);return{...n,effectiveDelta:r,currentPrice:b}})},[x]);return e.jsx("div",{className:"min-h-screen newspaper-bg text-zinc-900",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-10",children:[e.jsx("h1",{className:"gothic-title text-5xl md:text-6xl text-center font-black drop-shadow-sm",children:"The Timeless"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-10",children:[e.jsxs("div",{className:"card-nb p-6 md:p-8",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"text-xs text-zinc-500",children:"주목할 뉴스"})}),d?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mt-3 text-2xl md:text-3xl font-bold leading-snug",children:d.headline||"제목 없음"}),e.jsx("p",{className:"mt-4 whitespace-pre-wrap leading-relaxed text-[15px] md:text-base",children:d.body||""}),e.jsxs("div",{className:"mt-6 text-right text-xs text-zinc-500",children:["노출 시각:"," ",o(d.publishAt)?.toLocaleString?.()??"—"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mt-3 text-2xl md:text-3xl font-bold leading-snug",children:"(대기중)"}),e.jsx("p",{className:"mt-4 text-[15px] md:text-base text-zinc-600",children:"예약된 노출 시간이 되면 뉴스가 표시됩니다."})]})]}),e.jsxs("div",{className:"card-nb p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold tracking-wide",children:"시장 동향"}),e.jsx("span",{className:"text-xs text-zinc-500",children:"예약/실시간 반영"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_auto_auto] px-2 py-2 text-xs text-zinc-500 uppercase tracking-wider border-b",children:[e.jsx("div",{children:"주식사 / 설명"}),e.jsx("div",{className:"text-right pr-2",children:"등락%"}),e.jsx("div",{className:"text-right",children:"가격"})]}),u.length===0&&e.jsx("div",{className:"py-10 text-center text-zinc-500",children:"공개된 종목이 없습니다."}),u.map(c=>e.jsxs("div",{className:"grid grid-cols-[1fr_auto_auto] gap-2 items-center px-2 py-3 border-b last:border-b-0",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:c.name}),e.jsx("div",{className:"text-xs text-zinc-600",children:c.description})]}),e.jsx("div",{className:`text-right text-lg font-bold ${w(c.effectiveDelta)}`,children:y(c.effectiveDelta)}),e.jsx("div",{className:"text-right font-semibold tabular-nums",children:Number.isFinite(c.currentPrice)?c.currentPrice.toLocaleString():"—"})]},c.id))]})]})]})]})})}N.createRoot(document.getElementById("root")).render(e.jsx(v.StrictMode,{children:e.jsx(S,{})}));
